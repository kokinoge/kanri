# 要件文書

## 概要

SNSマーケティング支援代理店における月次予算管理の効率化とデータの可視化を目的とした予算管理システム。50人以下のマーケター、同時利用者数10人程度を対象とし、シンプルで使いやすいインターフェースでリアルタイムでの進捗把握を実現する。

## 要件

### 要件1：ユーザー認証・権限管理

**ユーザーストーリー:** システム管理者として、社員のアカウントを管理し、適切な権限を付与したい。これにより、データのセキュリティを確保し、役割に応じたアクセス制御を実現できる。

#### 受け入れ基準

1. WHEN ユーザーがログインページにアクセス THEN システムはメールアドレスとパスワードの入力フォームを表示する
2. WHEN 有効な認証情報でログイン THEN システムはユーザーの役割に応じたダッシュボードにリダイレクトする
3. WHEN 管理者がユーザー管理画面にアクセス THEN システムは全ユーザーの一覧と作成・編集・削除機能を提供する
4. IF ユーザーの役割がAdmin THEN システムは全機能へのアクセスを許可する
5. IF ユーザーの役割がManager THEN システムはデータ編集機能へのアクセスを許可し、ユーザー管理機能を制限する
6. IF ユーザーの役割がMember THEN システムはデータ閲覧機能のみを許可する

### 要件2：クライアント管理

**ユーザーストーリー:** マーケターとして、担当するクライアント情報を一元管理したい。これにより、クライアントごとの予算や施策を効率的に把握できる。

#### 受け入れ基準

1. WHEN ユーザーがクライアント一覧画面にアクセス THEN システムは登録済みクライアントの一覧を表示する
2. WHEN ユーザーが新規クライアント登録を実行 THEN システムは企業名、担当者、優先度の入力を求める
3. WHEN クライアント情報が正常に入力される THEN システムはクライアントを作成し、一覧に追加する
4. WHEN ユーザーがクライアント詳細画面にアクセス THEN システムは基本情報、関連施策、予算実績を表示する
5. IF ユーザーに編集権限がある THEN システムはクライアント情報の編集機能を提供する

### 要件3：施策・キャンペーン管理

**ユーザーストーリー:** マーケターとして、クライアントごとの施策を管理し、期間や予算を設定したい。これにより、複数の施策を体系的に管理できる。

#### 受け入れ基準

1. WHEN ユーザーが施策一覧画面にアクセス THEN システムは全施策の一覧をクライアント別に表示する
2. WHEN ユーザーが新規施策作成を実行 THEN システムは施策名、目的、期間、総予算の入力を求める
3. WHEN 施策情報が正常に入力される THEN システムは施策を作成し、指定クライアントに関連付ける
4. WHEN ユーザーが施策詳細画面にアクセス THEN システムは基本情報、予算配分、実績データを表示する
5. IF 施策の期間が設定されている THEN システムは開始日から終了日までの期間で予算管理を行う

### 要件4：予算管理

**ユーザーストーリー:** マーケターとして、施策ごとに媒体別・運用タイプ別の予算を設定し、月次で管理したい。これにより、詳細な予算配分と進捗管理ができる。

#### 受け入れ基準

1. WHEN ユーザーが予算設定画面にアクセス THEN システムは施策選択と月次予算入力フォームを表示する
2. WHEN 予算が媒体別に設定される THEN システムはX、Instagram、YouTube、TikTok、Threadsの各媒体予算を記録する
3. WHEN 予算が運用タイプ別に設定される THEN システムはマイクロIF、メガIF、広告運用、コンテンツ制作の各予算を記録する
4. WHEN 予算設定が完了する THEN システムは目標KPIと目標値の入力を求める
5. IF 予算vs実績の比較が要求される THEN システムは進捗率と差異を計算して表示する
6. WHEN ユーザーが前月予算の複製を実行 THEN システムは前月の予算設定を新しい月にコピーする

### 要件5：実績管理

**ユーザーストーリー:** マーケターとして、実際の支出と成果を記録し、予算との比較を行いたい。これにより、施策の効果測定と改善点の把握ができる。

#### 受け入れ基準

1. WHEN ユーザーが実績入力画面にアクセス THEN システムは施策・月・媒体・運用タイプの選択フォームを表示する
2. WHEN 実績データが入力される THEN システムは実際支出額と実際成果値を記録する
3. WHEN 実績入力が完了する THEN システムは予算との差異を自動計算して表示する
4. IF 実績が予算を超過している THEN システムは警告表示を行う
5. WHEN ユーザーが実績一覧を要求 THEN システムは期間・クライアント・媒体でフィルタリング可能な一覧を表示する

### 要件6：レポート・分析機能

**ユーザーストーリー:** マネージャーとして、全体の予算執行状況や媒体別の成果を可視化したレポートを確認したい。これにより、戦略的な意思決定を支援できる。

#### 受け入れ基準

1. WHEN ユーザーがダッシュボードにアクセス THEN システムは全体概要、進行中施策、予算執行率を表示する
2. WHEN ユーザーが月次レポートを要求 THEN システムは指定月の予算vs実績をグラフと表で表示する
3. WHEN ユーザーがクライアント別レポートを要求 THEN システムは指定クライアントの全施策データを表示する
4. WHEN ユーザーが媒体別分析を要求 THEN システムは各媒体の成果比較をChart.jsで可視化する
5. IF レポートデータが存在しない THEN システムは適切なメッセージを表示する
6. WHEN ユーザーがフィルタを適用 THEN システムは期間・クライアント・媒体による絞り込み結果を表示する

### 要件7：マスタデータ管理

**ユーザーストーリー:** システム管理者として、媒体、運用タイプ、報酬体系などのマスタデータを管理したい。これにより、システムの設定を柔軟に変更できる。

#### 受け入れ基準

1. WHEN 管理者がマスタ管理画面にアクセス THEN システムは媒体、運用タイプ、報酬体系の設定画面を表示する
2. WHEN 新しいマスタデータが追加される THEN システムはカテゴリ、値、表示順序を記録する
3. WHEN マスタデータが更新される THEN システムは関連する予算・実績データとの整合性を保持する
4. IF マスタデータが削除される THEN システムは関連データの存在確認を行い、警告を表示する
5. WHEN マスタデータの表示順序が変更される THEN システムは各画面での表示順序を更新する

### 要件8：データ永続化・パフォーマンス

**ユーザーストーリー:** システム利用者として、入力したデータが確実に保存され、50人同時アクセス時でも快適に利用したい。これにより、業務の継続性と効率性を確保できる。

#### 受け入れ基準

1. WHEN データが入力・更新される THEN システムはPostgreSQLデータベースに永続的に保存する
2. WHEN システムに50人が同時アクセス THEN システムは応答時間3秒以内でレスポンスを返す
3. WHEN 大量のデータが蓄積される THEN システムは全履歴データを保持し、検索・分析機能を提供する
4. IF データベース接続エラーが発生 THEN システムは適切なエラーメッセージを表示し、データ損失を防ぐ
5. WHEN レスポンシブデザインが要求される THEN システムはPC・タブレット・スマートフォンで適切に表示する